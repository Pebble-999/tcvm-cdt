English | [简体中文](./README.zh-CN.md)

# TCWasm Compile Tool

[![License Apache 2](https://img.shields.io/badge/license-apache%202-blue.svg?style=flat-square)](https://github.com/xunleichain/tcvm-cdt/blob/master/LICENSE)

TCWasm Compile Tool, providing local compilation tools and contract library file source code.

### Contract compilation
If you don't want to install the local environment, it is recommended that you use the web online compilation tool.
- [Catalyst](https://catalyst.onethingcloud.com/#/catalyst) Thunderchain IDE for the web. 
    Thunderchain contract compilation debugging tool, support evm and wasm.

#### Guided Installation (Building from local)

###### Install the wasm build environment
- Support OS Debian/Ubuntu 
- Install git, cmake > 3.4.3, make, python2.7.x to ensure that the disk free space is greater than 5GB
- Execute  `tcvm.cdt/wasm_build.sh`

###### Import environment variables
- Execute `source env.sh` in `tcvm.cdt` directory and import the environment variable<br>
Or
- add at the end of the `~/.bashrc` file
```
TCVM_CDT_DIR=<Absolute path of tcvm.cdt>
TCVM_CDT_BIN=<Absolute path of tcvm.cdt>/bin
export TCVM_CDT_DIR
export TCVM_CDT_BIN
```
- Execute `source ~/.bashrc`


###### Compile contract

Execute in the contract project directory
```
cmake -D CON_DIR=<contract project directory> <Absolute path of tcvm.cdt>
```

For example, in the example/hello directory of this repository, execute
```
cmake -D CON_DIR=${PWD} ../../tcvm.cdt/
make
```
After that, generate the `output.wasm` contract binary in the `example/hello` directory.

`Output.wasm` is the generated bytecode file, registered as a contract code.

### Docs
- [Guide](doc/guide.md) Wasm Contract Guidance

### Contract Example

##### Hello Thunderchain
````
#include "tcmethod.hpp"//Declare contract method
class Hello : public TCBaseContract{ //TCBaseContract Contract base class

public:
    const char* HelloThunder(){      //Contract class public member function
        return "Hello Thunderchain"; //Return Value
    }
};
TC_ABI(Hello, (HelloThunder))		//TC_ABI Declare contract external interface
````
See the `example` folder for more examples.


### Contract Test
Test contract recommendation tool
- [tc-wasm](https://github.com/xunleichain/tc-wasm) Thunderchain virtual machine
  `cmd/tcvm` Contract bytecode debugging tool
- [catalyst](https://catalyst.onethingcloud.com/#/catalyst)  Catalyst-Thunderchain IDE 
    Thunderchain contract compilation debugging tool, support evm and wasm. 
